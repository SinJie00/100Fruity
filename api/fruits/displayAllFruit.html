<html>

<head>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.js"></script>
</head>

<body>
    <h3>Fruits</h3>
    <table>
        <thead>
            <tr>
                <th>id</th>
                <th>name</th>
                <th>price</th>
                <th>amount</th>
            </tr>
        </thead>
        <tbody id="tBody"></tbody>
    </table>
</body>

<script>
    $(document).ready(function () {
        //event.preventDefault();
        //use this technique for ajax data if not using RESTFul
        //NOTE: this will capture the name attribute (not id) in our form
        //var formData = $(this).serialize();
        //console.log(formData); // check using console to make sure all the form data values are correctly serialized

        $.ajax({
            type: "get",
            url: "http://localhost/100Fruity/fruits",


            success: function (fruit, status, xhr) {
                /* var trHTML = '';
                $.each(fruit, function (i, data) {
                    trHTML +=
                        '<tr><td>'
                        + data.id
                        + '</td><td>'
                        + data.name
                        + '</td><td>'
                        + data.price
                        + '</td><td>'
                        + data.quantity
                        + '</td></tr>';

                });
                $('#tBody').append(trHTML); */

            },
            error: function (xhr, resp, text) {
                alert("error " + xhr + ", " + resp + ", " + text);
            },
        });
    });

    $("#deleteUser").submit(function (event) {
        event.preventDefault();
        //use this technique for ajax data if not using RESTFul
        //NOTE: this will capture the name attribute (not id) in our form
        var formData = $(this).serialize();
        var id = document.getElementById('upID').value;
        //console.log(id); // check using console to make sure all the form data values are correctly serialized

        $.ajax({
            type: "delete",
            url: "http://localhost/100Fruity/api/user/" + id,
            data: formData,
            dataType: "json",

            success: function (data, status, xhr) {
                console.log(data);
                if (data > 0) {
                    alert("ok, successfully delete data");
                } else {
                    alert("fail to delete, " + data.errormessage);
                }
            },
            error: function (xhr, resp, text) {
                alert("error " + xhr + ", " + resp + ", " + text);
            },
        });
    });

    $("#updateUser").submit(function (event) {
        event.preventDefault();
        //use this technique for ajax data if not using RESTFul
        //NOTE: this will capture the name attribute (not id) in our form
        var formData = $(this).serialize();
        var id = document.getElementById('upID').value;
        var name = document.getElementById('upName').value;
        var email = document.getElementById('upEmail').value;
        console.log(id + name + email);
        console.log(formData); // check using console to make sure all the form data values are correctly serialized

        $.ajax({
            type: "PUT",
            url: "http://localhost/100Fruity/api/user/" + id,
            data: {
                'id': id,
                'name': name,
                'email': email
            },
            dataType: "json",

            success: function (data) {
                console.log(data);
                if (data > 0) {
                    alert("ok, successfully update data");
                } else {
                    alert("fail to update, " + data.errormessage);
                }
            },
            error: function (xhr, resp, text) {
                alert("error " + xhr + ", " + resp + ", " + text);
            },
        });
    });
</script>